name: üèè Cricket Tweet Bot Scheduler

on:
  schedule:
    # Runs every hour from 3 AM to 5 PM UTC (8:30 AM to 10:30 PM IST)
    - cron: '30 3-17 * * *'
  
  # Allows manual trigger from GitHub UI
  workflow_dispatch:

jobs:
  post-tweet:
    runs-on: ubuntu-latest
    timeout-minutes: 15
    
    steps:
      - name: üì• Checkout Code
        uses: actions/checkout@v4
      
      - name: üêç Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.13'
      
      - name: üì¶ Install uv
        run: |
          curl -LsSf https://astral.sh/uv/install.sh | sh
          echo "${HOME}/.local/bin" >> $GITHUB_PATH
      
      - name: üìö Install Dependencies
        run: uv sync
      
      - name: üèè Run Cricket Tweet Bot
        env:
          X_API_KEY: ${{ secrets.X_API_KEY }}
          X_API_SECRET: ${{ secrets.X_API_SECRET }}
          X_ACCESS_TOKEN: ${{ secrets.X_ACCESS_TOKEN }}
          X_ACCESS_SECRET: ${{ secrets.X_ACCESS_SECRET }}
          X_BEARER_TOKEN: ${{ secrets.X_BEARER_TOKEN }}
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
          TAVILY_API_KEY: ${{ secrets.TAVILY_API_KEY }}
        run: |
          echo "üèè Starting Cricket Tweet Bot..."
          echo "‚è∞ UTC Time: $(date -u)"
          uv run python run_cricket_bot.py
